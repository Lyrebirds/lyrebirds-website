<app-article-template [title]="'Broadcom kabelmodem HTTPD Fejl'" [subtitle]="'03-02-2020'" [id]="'technicolor-httpd-server-vulnerability'" [hashtags]="'infosec'" [dedicated]="dedicated">
    <p class="mat-body-2">
        Technicolor har for nyligt offentliggjort en sårbarhed som tillader en angriber med eksisterende adgang til det
        lokale netwærk at initiere et denial of service angreb imod folks modem. Fejlen ligger i Broadcom referencekode
        og eksisterer derfor på alle kabelmodem som benytter Broadcom chipsættet, hvilket inkluderer langt størstedelen
        af kabelmodemmer i verden. Broadcom har endnu ikke udtalt sig officielt om sårbarheden og vi ved derfor ikke
        hvad strategien for en løsning er.
    </p>
    <p class="mat-body-2">
        Fejlen ligger i håndteringen af GET upgraderings requests som sendes til den interne mongoose HTTPD server på
        modemmet. Vi har kun været i stand til at bekræfte fejlen findes på spectrum analyzeren endpointet i modemmet,
        men der er mulighed for det også kan på lignende endpoints som hostes af modemmet. Antaget at fejlen kun findes
        på spectrum analyzeren ligner løsning/medigering af feljen meget det vi ser i <a href="https://cablehaunt.com" target="_blank">Cable Haunt</a>. Hvis en enhed på netwærket sender en fejlkonstrueret upgraderings request
        til modemmet rammer modemmet en null-pointer dereferining og crasher. Dette kan ske i 2 scenarier:
    </p>
    <ul>
        <li>Hvis 'Sec-WebSocket-Key' headeren eller kun en af 'Sec-WebSocket-Key1' og 'Sec-WebSocket-Key2' headerne er
            sat, når 'Sec-WebSocket-Version' headeren kræver begge.</li>
        <li>Hvis begge eller en af 'Sec-WebSocket-Key1' og 'Sec-WebSocket-Key2' headerne gives når
            'Sec-WebSocket-Version' headeren kun kræver 'Sec-WebSocket-Key' headeren.</li>
    </ul>
    <p class="mat-body-2">
        Fejlen kræver kontrol over en enhed på netwærket og kan ikke udnyttes igennem fx folks browsere, da de påkrævne
        GET-requests stoppes af CORS. Endvidere sættes de pågældne headere automatisk af de fleste klienter, så som
        browsere, og kode-biblioteker. Requestet kan dog sendes med fx curl således:
    </p>
    <code>
    curl -i -s -k -H $'Connection: Upgrade' -H $'Upgrade: websocket' -H $'Sec-WebSocket-Key: g+jhLrqMeJso0clv8s/qIg==' $'http://192.168.100.1:8080/Frontend'
</code>
    <p class="mat-body-2">
        Vi assisterede Technicolors interne sikkerhedspersonale med en dybere forståelse af fejlen da vi også stødte på
        den under vores arbejde med Cable Haunt. Eftersom vi ikke havde noget held eller direkte kontakt til Broadcom
        havde vi ikke mulighed for at rapportere og få udbedret fejlen. Eftersom Technicolor har direkte samarbejde med
        Broadcom, har de nu igangsat udbedringsprocessen.
    </p>
    <p class="mat-body-2">
        Sårbarheden er registreret som <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-7223" target="_blank">CVE-2020-7223</a>.
    </p>
</app-article-template>