<mat-card id="article-technicolor-httpd-server-vulnerability" class="example-card">
    <mat-card-header>
        <mat-card-title class="title">Broadcom kabelmodem HTTPD Fejl</mat-card-title>
        <mat-card-subtitle class="subtitle">03-02-2020</mat-card-subtitle>
    </mat-card-header>
    <mat-card-content id="article-content-technicolor-httpd-server-vulnerability" class="article-content expandable-article-content article-mask">
        <p class="mat-body-2">
            Technicolor har for nyligt offentliggjort en sårbarhed som tillader en angriber med eksisterende adgang til det lokale netwærk at initiere et denial of service angreb imod folks modem. Fejlen ligger i Broadcom referencekode og eksisterer derfor på alle kabelmodem som benytter Broadcom chipsættet, hvilket inkluderer langt størstedelen af kabelmodemmer i verden. Broadcom har endnu ikke udtalt sig officielt om sårbarheden og vi ved derfor ikke hvad strategien for en løsning er. 
        </p>
        <p class="mat-body-2">
            Fejlen ligger i håndteringen af GET upgraderings requests som sendes til den interne mongoose HTTPD server på modemmet. Vi har kun været i stand til at bekræfte fejlen findes på spectrum analyzeren endpointet i modemmet, men der er mulighed for det også kan på lignende endpoints som hostes af modemmet. Antaget at fejlen kun findes på spectrum analyzeren ligner løsning/medigering af feljen meget det vi ser i <a href="https://cablehaunt.com" target="_blank">Cable Haunt</a>. Hvis en enhed på netwærket sender en fejlkonstrueret upgraderings request til modemmet rammer modemmet en null-pointer dereferining og crasher. Dette kan ske i 2 scenarier:
        </p>
        <ul>
            <li>Hvis 'Sec-WebSocket-Key' headeren eller kun en af 'Sec-WebSocket-Key1' og 'Sec-WebSocket-Key2' headerne er sat, når 'Sec-WebSocket-Version' headeren kræver begge.</li>
            <li>Hvis begge eller en af 'Sec-WebSocket-Key1' og 'Sec-WebSocket-Key2' headerne gives når 'Sec-WebSocket-Version' headeren kun kræver 'Sec-WebSocket-Key' headeren.</li>
        </ul>
        <p class="mat-body-2">
            Fejlen kræver kontrol over en enhed på netwærket og kan ikke udnyttes igennem fx folks browsere, da de påkrævne GET-requests stoppes af CORS. Endvidere sættes de pågældne headere automatisk af de fleste klienter, så som browsere, og kode-biblioteker. Requestet kan dog sendes med fx curl således:
        </p>
        <code>
            curl -i -s -k -H $'Connection: Upgrade' -H $'Upgrade: websocket' -H $'Sec-WebSocket-Key: g+jhLrqMeJso0clv8s/qIg==' $'http://192.168.100.1:8080/Frontend'
        </code>
        <p class="mat-body-2">
            Vi assisterede Technicolors interne sikkerhedspersonale med en dybere forståelse af fejlen da vi også stødte på den under vores arbejde med Cable Haunt. Eftersom vi ikke havde noget held eller direkte kontakt til Broadcom havde vi ikke mulighed for at rapportere og få udbedret fejlen. Eftersom Technicolor har direkte samarbejde med Broadcom, har de nu igangsat udbedringsprocessen.
        </p>
        <p class="mat-body-2">
            Sårbarheden er registreret som <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-7223" target="_blank">CVE-2020-7223</a>.
        </p>
    </mat-card-content>
    <mat-card-actions class="action-buttons">
        <mat-menu #appMenu="matMenu">
            <a mat-menu-item target="_blank"
                href='mailto:?Subject=Cable Haunt sikkerhedshul&amp;Body=Jeg s&#229; dette sikkerhedshul og t&#230;nket det kunne interessere dig. {{currentUrl}}#article-technicolor-httpd-server-vulnerability'
                color="primary">
                <fa-icon [icon]="['far', 'envelope']"></fa-icon> Mail
            </a>
            <a mat-menu-item target="_blank"
                href='http://www.facebook.com/sharer.php?u={{currentUrl}}/#article-technicolor-httpd-server-vulnerability'
                color="primary">
                <fa-icon [icon]="['fab', 'facebook']"></fa-icon> Facebook
            </a>
            <a mat-menu-item target="_blank"
                href='http://www.linkedin.com/shareArticle?url={{currentUrl}}#article-technicolor-httpd-server-vulnerability'
                color="primary">
                <fa-icon [icon]="['fab', 'linkedin']"></fa-icon> LinkedIn
            </a>
            <a mat-menu-item target="_blank"
                href='https://twitter.com/share?url={{currentUrl}}#article-technicolor-httpd-server-vulnerability&amp;text=Cable Haunt sikkerhedshul&amp;hashtags=cablehaunt'
                color="primary">
                <fa-icon [icon]="['fab', 'twitter']"></fa-icon> Twitter
            </a>
        </mat-menu>
        <button mat-button color="primary" [matMenuTriggerFor]="appMenu">
            <mat-icon>share</mat-icon> {{ 'NEWS.ARTICLE_BUTTONS.SHARE' | translate}}
        </button>
        <button mat-button color="primary"
            (click)="toggleCollapseArticle('article-content-technicolor-httpd-server-vulnerability', 'button-technicolor-httpd-server-vulnerability');">
            <mat-icon>visibility</mat-icon><a id="button-technicolor-httpd-server-vulnerability">
                {{ 'NEWS.ARTICLE_BUTTONS.MORE' | translate}}</a>
        </button>
    </mat-card-actions>
</mat-card>